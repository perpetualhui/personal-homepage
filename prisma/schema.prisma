generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Article {
  id            String    @id @default(cuid())
  title         String
  slug          String    @unique
  description   String?
  content       String    @db.Text
  cover         String?
  category      String    @default("æœªåˆ†ç±»")
  tags          String[]  @default([])
  featured      Boolean   @default(false)
  status        String    @default("published")
  readingTime   Int       @default(1)
  author        String    @default("ç°ç°")
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt

  // æ–°å¢å­—æ®µ - åª’ä½“å…³è”
  coverMediaId  String?  @unique
  coverMedia    Media?   @relation("ArticleCover", fields: [coverMediaId], references: [id])
  medias        Media[]

  // æ–°å¢å­—æ®µ - è‰ç¨¿æ”¯æŒï¼ˆPhase 4 è‡ªåŠ¨ä¿å­˜ç³»ç»Ÿï¼‰
  lastSavedAt   DateTime?
  draftContent  String?   @db.Text
  draftVersion  Int       @default(0)
}

model Project {
  id          String   @id @default(cuid())
  title       String
  description String   @db.Text
  icon        String   @default("ğŸ“")
  tags        String[] @default([])
  github      String?
  demo        String?
  docs        String?
  featured    Boolean  @default(false)
  status      String   @default("active")
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Skill {
  id        String   @id @default(cuid())
  name      String
  category  String   @default("æŠ€æœ¯")
  level     Int      @default(50)
  order     Int      @default(0)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Profile {
  id        String   @id @default(cuid())
  name      String   @default("ç°ç°")
  tagline   String   @default("AIçˆ±å¥½è€… / Vibe Codingå­¦ä¹ è€…")
  avatar    String   @default("/avatar.jpg")
  features  String[] @default([])
  storyTitle String  @default("å…³äºæˆ‘çš„æ•…äº‹")
  storyContent String[] @default([])
  github    String?
  twitter   String?
  email     String?
  status    String   @default("å¼€æ”¾åˆä½œ")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([id])
}

model Tool {
  id          String   @id @default(cuid())
  name        String
  icon        String
  description String   @db.Text
  tags        String[] @default([])
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Subscriber {
  id        String   @id @default(cuid())
  email     String   @unique
  name      String?
  active    Boolean  @default(true)
  createdAt DateTime @default(now())
}

model Message {
  id        String   @id @default(cuid())
  name      String
  email     String
  subject   String?
  content   String   @db.Text
  type      String   @default("contact")
  read      Boolean  @default(false)
  replied   Boolean  @default(false)
  createdAt DateTime @default(now())
}

model Media {
  id           String   @id @default(cuid())
  filename     String
  originalName String
  mimeType     String
  size         Int
  width        Int?     // å›¾ç‰‡å®½åº¦
  height       Int?     // å›¾ç‰‡é«˜åº¦
  url          String   @unique  // Vercel Blob URL
  blobUrl      String   // Blob å­˜å‚¨è·¯å¾„
  category     String   @default("image")  // image, video, document, other
  alt          String?  // å›¾ç‰‡æè¿°
  folder       String   @default("root")  // æ–‡ä»¶å¤¹ç»„ç»‡
  optimized    Boolean  @default(false)  // æ˜¯å¦å·²ä¼˜åŒ–
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  // å…³è”æ–‡ç« ï¼ˆå¯é€‰ï¼‰
  articleId       String?
  article         Article?  @relation(fields: [articleId], references: [id])

  // å°é¢å›¾å…³è”ï¼ˆå¯é€‰ï¼‰
  coverArticleId  String?  @unique
  coverArticle    Article?  @relation("ArticleCover")

  @@index([category])
  @@index([folder])
  @@index([createdAt])
}
